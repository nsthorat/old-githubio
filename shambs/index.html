<script type="text/javascript">
  // Constants
  var pixelsPerHalfHour = 100;

  var events = [];
  function load(csv_data) {
    setTimeout(function() {
      var events_raw = csv_data.split("|");
      for (var i = 0; i < events_raw.length; i++) {
        var values = events_raw[i].split(",");
        var start = new Date(values[0].replace(" ", "T"));
        start.setTime(start.getTime() + 4 * 60 * 60 * 1000);
        var end = new Date(values[1].replace(" ", "T"));
        end.setTime(end.getTime() + 4 * 60 * 60 * 1000);
        events.push({
          'raw': values,
          'start': start,
          'end': end,
          'artist': values[2],
          'stage': values[3]
        })
      }
      console.log(events);

      initTime();
    }, 0);
  }

  function initTime() {
    var minTime, maxTime;
    for (var i = 0; i < events.length; i++) {
      if (!minTime || events[i]['start'] < minTime) {
        minTime = events[i]['start'];
        console.log("MIN: ");
        console.log(events[i]['raw']);
        console.log(minTime);
      }
      if (!maxTime || events[i]['end'] > maxTime) {
        maxTime = events[i]['end'];
      }
    }

    console.log(minTime);
    console.log("-----");
    var time = document.getElementById('time');
    var numSlots = (maxTime - minTime) / 1000 / 60 / 30;
    for (var i = 0; i < numSlots; i++) {
      var slot = document.createElement('div');
      slot.className = "time-slot";
      console.log("millis: " + minTime.getTime());
      var slotDate = new Date(i * 30 * 60 * 1000 + minTime.getTime());

      console.log(slotDate.toString());


      var hours = slotDate.getHours();
      var ampm = "am";
      if (hours >= 12) {
        ampm = "pm";
        if (hours >= 13) {
          hours -= 12;
        }
      } else if (hours == 0) {
        hours = 12;
      }


      slot.innerText = slotDate.getMonth() + "/" + slotDate.getDay() + " " + hours + ":" + (slotDate.getMinutes() + "0").slice(0, 2) + ampm;
      time.appendChild(slot);
      console.log(slot.innerText);
    }
  }
</script>
<script src="funkschedule.js"></script>
<style type="text/css">
  body {
    font-family: Open Sans, Helvetica;
  }
  .time-slot {
    height: 200px;
    border-bottom: 1px solid #ccc;
    font-size: 40px;
    margin-bottom: -1px;

  }
  #time {
  }
</style>

<div id="schedule">
  <div id="time">
  </div>
</div>
